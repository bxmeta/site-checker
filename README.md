# Site Monitor

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∞–π—Ç–æ–≤ —Å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –≤ Telegram.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **HTTP-–ø—Ä–æ–≤–µ—Ä–∫–∏**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ –æ—Ç–≤–µ—Ç–∞
- **SSL-–ø—Ä–æ–≤–µ—Ä–∫–∏**: –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–æ–º–µ–Ω—É
- **–ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞**: –ø–æ–∏—Å–∫ –∑–∞–¥–∞–Ω–Ω—ã—Ö —Å–ª–æ–≤ –≤ HTML-–∫–æ–Ω—Ç–µ–Ω—Ç–µ
- **Retry-–ª–æ–≥–∏–∫–∞**: –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ –Ω–µ—É–¥–∞—á–µ
- **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram**: –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–∞–π—Ç–æ–≤
- **Telegram-–±–æ—Ç**: —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã
- **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∑–∞–ø–∏—Å—å –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ —Ñ–∞–π–ª

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
pip install -r requirements.txt
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°–æ–∑–¥–∞–π—Ç–µ Telegram-–±–æ—Ç–∞

1. –ù–∞–ø–∏—à–∏—Ç–µ [@BotFather](https://t.me/BotFather) –≤ Telegram
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞

### 2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª `config.yaml`:

```yaml
telegram:
  bot_token: "YOUR_BOT_TOKEN"  # –¢–æ–∫–µ–Ω –æ—Ç BotFather
  admin_ids: [123456789]       # –í–∞—à Telegram ID (–º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å —á–µ—Ä–µ–∑ /myid)

scheduler:
  interval_minutes: 3          # –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ –º–∏–Ω—É—Ç–∞—Ö

default:
  retry_count: 3               # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
  retry_interval_minutes: 5    # –ò–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø–æ–ø—ã—Ç–∫–∞–º–∏
  timeout_seconds: 10          # –¢–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞

sites:
  - id: "site1"
    name: "Example"
    url: "https://example.com"
    support_level: "premium"   # none / standard / premium
    check_ssl: true
    check_http_code: true
    expected_code: 200
    keywords: ["Example", "Domain"]
    notify_users: [123456789]  # –ö–æ–º—É –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```

## –ó–∞–ø—É—Å–∫

```bash
python main.py
```

## –ö–æ–º–∞–Ω–¥—ã Telegram-–±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|---------|----------|--------|
| `/start` | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è | –í—Å–µ |
| `/myid` | –ü–æ–∫–∞–∑–∞—Ç—å Telegram ID | –í—Å–µ |
| `/my_sites` | –°–ø–∏—Å–æ–∫ –≤–∞—à–∏—Ö —Å–∞–π—Ç–æ–≤ | –í—Å–µ |
| `/status_all` | –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö —Å–∞–π—Ç–æ–≤ | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã |
| `/check_now` | –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã |
| `/sites` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞–º–∏ (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é) | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã |
| `/add_site` | –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–∞–π—Ç (–ø–æ—à–∞–≥–æ–≤—ã–π –º–∞—Å—Ç–µ—Ä) | –¢–æ–ª—å–∫–æ –∞–¥–º–∏–Ω—ã |

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞–º–∏ —á–µ—Ä–µ–∑ –±–æ—Ç–∞ (–¥–ª—è –∞–¥–º–∏–Ω–æ–≤)

–ü–æ—Å–ª–µ –∫–æ–º–∞–Ω–¥—ã `/sites` –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –º–µ–Ω—é —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏:

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–∞–π—Ç–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- –°—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ —Å–∞–π—Ç–∞ (üü¢ UP / üî¥ DOWN)
- –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∞–π—Ç–µ

### –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∞–π—Ç–∞
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ URL
- –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (none/standard/premium)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ HTTP –∫–æ–¥–∞
- –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ SSL
- –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ HTTP –∫–æ–¥–∞
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º–∏
- –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ —Å–∞–π—Ç–∞
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞ –ø–æ Telegram ID
- –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ —É–¥–∞–ª–µ–Ω–∏–µ
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–∞–π—Ç–∞
- –£–¥–∞–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞ (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º)

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–∞–π—Ç–∞
–ö–æ–º–∞–Ω–¥–∞ `/add_site` –∏–ª–∏ –∫–Ω–æ–ø–∫–∞ "‚ûï –î–æ–±–∞–≤–∏—Ç—å —Å–∞–π—Ç" –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ—à–∞–≥–æ–≤—ã–π –º–∞—Å—Ç–µ—Ä:
1. –í–≤–æ–¥ —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ ID (–ª–∞—Ç–∏–Ω—Å–∫–∏–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã, –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞–Ω–∏–µ)
2. –í–≤–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏—è —Å–∞–π—Ç–∞
3. –í–≤–æ–¥ URL
4. –í—ã–±–æ—Ä —É—Ä–æ–≤–Ω—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
5. –í–≤–æ–¥ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ HTTP –∫–æ–¥–∞
6. –í–≤–æ–¥ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ `-` –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞)
7. –í–≤–æ–¥ Telegram ID –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é –∏–ª–∏ `-` –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
/site-checker/
‚îú‚îÄ‚îÄ monitor/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config_loader.py     # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ state_manager.py     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
‚îÇ   ‚îú‚îÄ‚îÄ checker.py           # HTTP-–ø—Ä–æ–≤–µ—Ä–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ ssl_checker.py       # SSL-–ø—Ä–æ–≤–µ—Ä–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ keyword_checker.py   # –ü–æ–∏—Å–∫ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ retry_logic.py       # –õ–æ–≥–∏–∫–∞ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ notifier.py          # Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ scheduler.py         # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ telegram_bot.py      # Telegram-–±–æ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ logger.py            # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ time_utils.py        # –†–∞–±–æ—Ç–∞ —Å –≤—Ä–µ–º–µ–Ω–µ–º
‚îú‚îÄ‚îÄ main.py                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ config.yaml              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ state.json               # –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∞–π—Ç–æ–≤
‚îú‚îÄ‚îÄ users.json               # –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
‚îú‚îÄ‚îÄ monitor.log              # –§–∞–π–ª –ª–æ–≥–æ–≤
‚îú‚îÄ‚îÄ requirements.txt         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îî‚îÄ‚îÄ README.md
```

## –¢–∏–ø—ã –æ—à–∏–±–æ–∫

| –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|----------|
| `timeout` | –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è |
| `no_response` | –ù–µ—Ç –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ |
| `wrong_code` | –ù–µ–≤–µ—Ä–Ω—ã–π HTTP-–∫–æ–¥ |
| `ssl_expired` | SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∏—Å—Ç—ë–∫ |
| `ssl_mismatch` | SSL-—Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –¥–æ–º–µ–Ω—É |
| `keyword_missing` | –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ |

## –§–æ—Ä–º–∞—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

### –ü–∞–¥–µ–Ω–∏–µ —Å–∞–π—Ç–∞
```
üö® –°–∞–π—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
–ù–∞–∑–≤–∞–Ω–∏–µ: Example
URL: https://example.com
–°—Ç–∞—Ç—É—Å –ø–æ–¥–¥–µ—Ä–∂–∫–∏: premium
–û—à–∏–±–∫–∞: Timeout
–ö–æ–¥: N/A
–í—Ä–µ–º—è: 01.01.2025 12:00:00 (UTC+4)
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–π—Ç–∞
```
‚úÖ –°–∞–π—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
–ù–∞–∑–≤–∞–Ω–∏–µ: Example
URL: https://example.com
–°—Ç–∞—Ç—É—Å –ø–æ–¥–¥–µ—Ä–∂–∫–∏: premium
–ö–æ–¥: 200
–í—Ä–µ–º—è: 01.01.2025 12:05:00 (UTC+4)
```

## –§–æ—Ä–º–∞—Ç –ª–æ–≥–æ–≤

```
[2025-01-01 12:00:00+0400] [site1] OK (200) 150ms
[2025-01-01 12:05:00+0400] [site1] ERROR Timeout
```

## –¢–∞–π–º–∑–æ–Ω–∞

–í—Å–µ –≤—Ä–µ–º–µ–Ω–∞ –≤ –ª–æ–≥–∞—Ö, –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö —É–∫–∞–∑–∞–Ω—ã –≤ —Ç–∞–π–º–∑–æ–Ω–µ **UTC+4** (Europe/Samara, –ò–∂–µ–≤—Å–∫).

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT
